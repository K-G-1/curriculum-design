C51 COMPILER V9.00   MAIN                                                                  12/01/2018 13:21:26 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: H:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

*** WARNING C500 IN LINE 1 OF MAIN.C: LICENSE ERROR (R208: RENEW LICENSE ID CODE (LIC))

   1          #include"all.h"
   2          uint count1,count2;
   3          uint systick_cnt = 0;                                                   //心跳时钟计数 
   4          uint ms_10,ms_100,ms_500,ms_1000 = 0;                   // 调用频率
   5          
   6          uint PWM_Left = 20;
   7          uint PWM_Right = 20;
   8          uint PWM_Left_cnt = 0;
   9          uint PWM_Right_cnt = 0;
  10          
  11          void init()
  12          {
  13   1              TMOD=0x11;          //定义定时器0工作方式1
  14   1              TH0=(65536-1000)/256;     // 12M时钟就是1ms的计时
  15   1              TL0=(65536-1000)%256;
  16   1              TH1=(65536-500)/256;      // 12M时钟就是1ms的计时
  17   1              TL1=(65536-500)%256;
  18   1              EA=1;
  19   1              ET0=1;
  20   1              TR0=1;
  21   1              ET1=1;
  22   1              TR1=1;
  23   1      }
  24          
  25          void task(void)
  26          {
  27   1              //读取火焰传感器与避障传感器
  28   1              if(ms_10 == 1)
  29   1              {
  30   2                       ms_10 = 0;
  31   2                       detection_IO();
  32   2                       display(voltage);
  33   2              }
  34   1              // 行驶逻辑
  35   1              if(ms_100 == 1)
  36   1              {
  37   2                      ms_100 = 0;
  38   2      
  39   2                      travel_task(10);
  40   2              }
  41   1              // ADC任务
  42   1              if(ms_500 == 1)
  43   1              {
  44   2                        ADC_task();
  45   2              }
  46   1              //led显示，也可以当做报警设置
  47   1              if(ms_1000 == 1)
  48   1              {
  49   2                       ms_1000 = 0;
  50   2                       
  51   2                       LED_task(machine_status);
  52   2              }
  53   1      }
  54          void main()
C51 COMPILER V9.00   MAIN                                                                  12/01/2018 13:21:26 PAGE 2   

  55          {
  56   1              
  57   1              init();
  58   1              P0=0x00;
  59   1              P1=0x00;
  60   1              P2=0x00;
  61   1              P2=0x00;
  62   1      //      PWM1 = 1;
  63   1      //      PWM2 = 1;
  64   1              Forward();
  65   1              while(1)
  66   1              {
  67   2                      // 任务调用
  68   2                      task();
  69   2                      
  70   2      
  71   2              }
  72   1      
  73   1      }
  74          //这个中断最好不要修改
  75          void  time0() interrupt 1
  76          {
  77   1              TH0=(65536-1000)/256;
  78   1              TL0=(65536-1000)%256;
  79   1              systick_cnt ++;
  80   1      
  81   1              if(systick_cnt %10 == 0)
  82   1                      ms_10 = 1;
  83   1              if(systick_cnt % 100 == 0)
  84   1                      ms_100 = 1 ;
  85   1              if(systick_cnt % 500 == 0)
  86   1                      ms_500 = 1 ;
  87   1              if(systick_cnt % 1000 == 0)
  88   1                      ms_1000 = 1 ;
  89   1      
  90   1      }
  91          
  92          
  93          void  time1() interrupt 3
  94          {
  95   1              TH1=(65536-500)/256;
  96   1              TL1=(65536-500)%256;
  97   1              PWM_Left_cnt ++;
  98   1              PWM_Right_cnt++;
  99   1      
 100   1              if(PWM_Left_cnt > PWM_Left)
 101   1                      PWM1 = 1;
 102   1      
 103   1              if(PWM_Left_cnt >= Full_PWM)
 104   1              {
 105   2                      PWM_Left_cnt = 0;
 106   2                      PWM1 = 0;
 107   2              }
 108   1      
 109   1              if(PWM_Right_cnt > PWM_Right)
 110   1                      PWM2 = 1;
 111   1      
 112   1              if(PWM_Right_cnt >= Full_PWM)
 113   1              {
 114   2                      PWM_Left_cnt = 0;
 115   2                      PWM2 = 0;
 116   2              }
C51 COMPILER V9.00   MAIN                                                                  12/01/2018 13:21:26 PAGE 3   

 117   1      
 118   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    338    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     22    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
